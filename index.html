<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>ãƒ“ãƒ³ã‚´ v0r</title>
<style>
  body {
    font-family: sans-serif;
    display: flex;
    flex-direction: column;
    align-items: center;
    margin: 10px;
  }
  h1 { margin-bottom: 20px; }

  .bingo {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    grid-template-rows: repeat(5, 1fr);
    width: 90vw;
    height: 90vw;
    max-width: 700px;
    max-height: 700px;
    gap: 0;
    box-sizing: border-box;
  }

  .cell {
    background-color: #fff;
    border: 1.5px solid #000;
    display: flex;
    justify-content: center;
    align-items: center;
    text-align: center;
    cursor: pointer;
    user-select: none;
    position: relative;
    aspect-ratio: 1/1;
    padding: 4px;
    word-break: break-word;
    white-space: pre-wrap;
    font-size: clamp(12px, 2vw, 20px);
  }

  .cell.checked::after {
    content: "";
    position: absolute;
    top: 15%; left: 15%; bottom: 15%; right: 15%;
    border: 3px solid red;
    border-radius: 50%;
    pointer-events: none;
  }

  .cell.checked span.main { color: #000; font-weight: bold; }

  .cell .date {
    position: absolute;
    bottom: 2px;
    right: 2px;
    font-size: 0.6em;
    color: #888;
    pointer-events: none;
  }

  .cell input.date-input {
    position: absolute;
    bottom: 2px; /* å³ä¸‹ã«é…ç½® */
    right: 2px;
    font-size: 0.8em;
    width: 90px; /* ã‚µã‚¤ã‚ºèª¿æ•´ */
    background-color: #f9f9f9; /* èƒŒæ™¯è‰²ã‚’ç°è‰²ã« */
    border: 1px solid #ccc; /* æ ç·šã‚’è¿½åŠ  */
    border-radius: 4px; /* è§’ã‚’ä¸¸ã */
    padding: 2px;
    z-index: 10; /* ä»–ã®è¦ç´ ã‚ˆã‚Šå‰é¢ã«è¡¨ç¤º */
    text-align: center; /* ãƒ†ã‚­ã‚¹ãƒˆã‚’ä¸­å¤®æƒãˆ */
  }

  /* å¤–å‘¨å¤ªç·š */
  .cell:nth-child(-n+5) { border-top: 4px solid #000; }
  .cell:nth-child(5n+1) { border-left: 4px solid #000; }
  .cell:nth-child(5n) { border-right: 4px solid #000; }
  .cell:nth-last-child(-n+5) { border-bottom: 4px solid #000; }

  /* ã‚¹ãƒãƒ›å‘ã‘èª¿æ•´ */
  @media (max-width: 600px) {
    body {
      margin: 0;
      padding: 0;
      align-items: flex-start; /* å·¦å¯„ã› */
    }
    h1 {
      font-size: 1.2em;
      margin: 5px 10px;
    }
    .bingo {
      width: 85vw;
      height: 85vw;
      max-width: 300px;
      max-height: 300px;
      margin-left: 10px; /* å·¦å¯„ã› */
    }
    .cell {
      font-size: clamp(8px, 2vw, 10px);
      padding: 1px;
    }
    .cell input.date-input {
      width: 70px;
      font-size: 0.6em;
    }
  }
</style>
</head>
<body>

<h1>ãƒ“ãƒ³ã‚´ v0r7</h1>
<div class="bingo" id="bingo"></div>

<script>
const bingoDiv = document.getElementById('bingo');

const items = [
  "ã‚»ãƒ«1\nãƒ†ã‚¹ãƒˆ",
  "ã‚»\"ãƒ«2\nãƒ†ã‚¹ãƒˆ",
  "ã‚»'ãƒ«3\nãƒ†ã‚¹ãƒˆ",
  "ã‚»<ãƒ«4>\nãƒ†ã‚¹ãƒˆ",
  "ã‚»&ãƒ«5\nãƒ†ã‚¹ãƒˆ",
  "é•·ã„æ–‡å­—åˆ—ãƒ†ã‚¹ãƒˆé•·ã„æ–‡å­—åˆ—ãƒ†ã‚¹ãƒˆé•·ã„æ–‡å­—åˆ—ãƒ†ã‚¹ãƒˆ\nã‚»ãƒ«6",
  "æ”¹è¡Œ\nãƒ†ã‚¹ãƒˆ\nã‚»ãƒ«7",
  "ã‚¿ãƒ–\tæ–‡å­—ã‚»ãƒ«8",
  "ç‰¹æ®Š!@#$%^&*()_+ã‚»ãƒ«9",
  "å…¨è§’æ–‡å­—å…¨è§’æ–‡å­—å…¨è§’æ–‡å­—ã‚»ãƒ«10",
  "åŠè§’ï½¶ï¾€ï½¶ï¾…ã‚»ãƒ«11",
  "çµµæ–‡å­—ğŸ˜Šã‚»ãƒ«12",
  "HTMLã‚¿ã‚°<p>ã‚»ãƒ«13</p>",
  "ç©ºæ–‡å­—ã‚»ãƒ«14",
  "\nã‚»ãƒ«15",
  "ã‚»ãƒ«16\nçµ‚ã‚ã‚Š",
  "ã‚»ãƒ«17 / ãƒãƒƒã‚¯ã‚¹ãƒ©ãƒƒã‚·ãƒ¥\\",
  "è¤‡é›‘æ–‡å­—åˆ—<>\"'&\nã‚»ãƒ«18",
  "ã‚»ãƒ«19\n\n\n",
  "é•·ã„æ”¹è¡Œ\né•·ã„æ”¹è¡Œ\nã‚»ãƒ«20",
  "ã‚»ãƒ«21\u2603",
  "ã‚»ãƒ«22\u2764",
  "ã‚»ãƒ«23\nç‰¹æ®Šè¨˜å·!@#",
  "ã‚»ãƒ«24 & < > \" ' \nãƒ†ã‚¹ãƒˆ",
  "ã‚»ãƒ«25 æœ€å¾Œã®ãƒ†ã‚¹ãƒˆæ–‡å­—åˆ—"
];

  // ä¿å­˜ã•ã‚ŒãŸçŠ¶æ…‹ã‚’å¾©å…ƒã™ã‚‹é–¢æ•°
  function loadState() {
    const savedState = JSON.parse(localStorage.getItem('bingoState')) || [];
    savedState.forEach((state, index) => {
      const cell = bingoDiv.children[index];
      if (state.checked) {
        cell.classList.add('checked');
      }
      if (state.date) {
        const dateSpan = cell.querySelector('.date');
        dateSpan.textContent = state.date;
      }
    });
  }

  // ç¾åœ¨ã®çŠ¶æ…‹ã‚’ä¿å­˜ã™ã‚‹é–¢æ•°a
  function saveState() {
    const state = Array.from(bingoDiv.children).map(cell => {
      return {
        checked: cell.classList.contains('checked'),
        date: cell.querySelector('.date').textContent
      };
    });
    localStorage.setItem('bingoState', JSON.stringify(state));
  }

  items.forEach(item => {
    const cell = document.createElement('div');
    cell.className = 'cell';

    const mainSpan = document.createElement('span');
    mainSpan.className = 'main';
    mainSpan.textContent = item;
    cell.appendChild(mainSpan);

    const dateSpan = document.createElement('span');
    dateSpan.className = 'date';
    cell.appendChild(dateSpan);

    let tapTimeout;
    let isDoubleTap = false;

    function handleTap(event) {
      event.preventDefault(); // ãƒ‡ãƒ•ã‚©ãƒ«ãƒˆå‹•ä½œã‚’é˜²æ­¢

      const input = cell.querySelector('input.date-input');
      if (input) {
        // æ—¥ä»˜å…¥åŠ›æ¬„ãŒå­˜åœ¨ã—ã¦ã„ã¦ã‚‚ãƒã‚§ãƒƒã‚¯ã‚’ãƒˆãƒªã‚¬ãƒ¼
        toggleCheck();
        return;
      }

      if (tapTimeout) {
        clearTimeout(tapTimeout);
        isDoubleTap = true;
        handleDoubleTap(); // ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—ã§æ—¥ä»˜å…¥åŠ›ã‚’ãƒˆãƒªã‚¬ãƒ¼
      } else {
        isDoubleTap = false;
        tapTimeout = setTimeout(() => {
          toggleCheck(); // ã‚·ãƒ³ã‚°ãƒ«ã‚¿ãƒƒãƒ—ã§ãƒã‚§ãƒƒã‚¯åˆ‡ã‚Šæ›¿ãˆ
          tapTimeout = null;
        }, 300); // ãƒ€ãƒ–ãƒ«ã‚¿ãƒƒãƒ—åˆ¤å®šæ™‚é–“
      }
    }

    function toggleCheck() {
      cell.classList.toggle('checked'); // ãƒã‚§ãƒƒã‚¯çŠ¶æ…‹ã‚’åˆ‡ã‚Šæ›¿ãˆ
      saveState(); // çŠ¶æ…‹ã‚’ä¿å­˜
    }

    function handleDoubleTap() {
      let input = cell.querySelector('input.date-input');
      if (!input) {
        input = document.createElement('input');
        input.type = 'text';
        input.placeholder = 'YYYY-MM-DD';
        input.className = 'date-input';
        cell.appendChild(input);
        input.focus();

        input.addEventListener('blur', () => {
          if (input.value.trim() !== '') {
            dateSpan.textContent = input.value;
            saveState(); // çŠ¶æ…‹ã‚’ä¿å­˜
          }
          cell.removeChild(input);
        });
      } else {
        input.focus(); // æ—¢å­˜ã®å…¥åŠ›æ¬„ãŒã‚ã‚Œã°ãƒ•ã‚©ãƒ¼ã‚«ã‚¹ã‚’ç§»å‹•
      }
    }

    cell.addEventListener('click', handleTap); // ã‚¤ãƒ™ãƒ³ãƒˆã‚’clickã«çµ±ä¸€

    bingoDiv.appendChild(cell);
  });

  // ãƒšãƒ¼ã‚¸èª­ã¿è¾¼ã¿æ™‚ã«çŠ¶æ…‹ã‚’å¾©å…ƒ
  loadState();
</script>

</body>
</html>
